#!/bin/bash
# Written by Shaun Jackman <sjackman@gmail.com>.

set -e
if [ $# != 2 ]; then
	cat <<EOF
Usage: abyss-split N FILE
Split FILE into N parts named FILE-XX.fa.
EOF
	exit 1
fi
n=$1
path=$2
if [ $n -lt 2 -o $n -gt 100 ]; then
	echo 'abyss-split: 2 <= n <= 100' 2>&1
	exit 1
fi

let l=`wc -l <$path`
echo $path: $l
let pairs="($l/4 + $n-1)/$n"
let lines=4*$pairs
prefix=${path%.*}-

echo split -dl$lines $path $prefix
split -dl$lines $path $prefix
for i in $prefix[0-9][0-9]; do
	mv $i $i.fa
done
